<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <script src="https://cdn.jsdelivr.net/npm/danfojs@1.2.0/lib/bundle.min.js"></script>
     <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
	    <title>Document</title>
</head>

<body>
<input type="file" id="file" name="file">
<div id="regionalSales"></div>
<div id="salesByRegionAndProduct"></div>
<div id="productSatisfaction"></div>
<div id="productSatisfactionByGender"></div>
<div id="productSatisfactionByAgeGroup"></div>
<div id="salesByProductAndGender"></div>
<div id="productSales"></div>
<div id="salesByProductAndAgeGroup"></div>
<div id="salesByProductGenderAndAgeGroup"></div>
<div id="salesByMonth"></div>
<div id="salesByAgeGroup"></div>
<div id="salesByAgeGroupAndGender"></div>
<div id="salesByDayOfWeek"></div>
<div id="salesByDayAndProduct"></div>

<script type="text/javascript">

  const MYPROCESSDATA = (data, columns) => {
    console.log(columns);

    processProductSales("Widget A")
    processProductSales("Widget B")
    processProductSales("Widget C")
    processProductSales("Widget D")

    function processProductSales(productName){
      const widgetARows = data.filter(row => row[1] == productName)
      console.log(widgetARows);

      let widgetATotalSales = 0;
      let monthMap = {}
      widgetARows.forEach( r => {
        widgetATotalSales += r[3];
        const yearAndMonth = r[0].slice(0,7)
        if(!monthMap[yearAndMonth]){
          monthMap[yearAndMonth] = []
        }
        monthMap[yearAndMonth].push(r[3])
      })
      console.log(productName + " TOTAL SALES: " + widgetATotalSales)
      console.log(productName + " AVG SALES: " + widgetATotalSales/widgetARows.length)
      console.log(monthMap);

      const avgMonthlySales = {};
      for(key in monthMap){
        avgMonthlySales[key] = monthMap[key].reduce((ac, cv) => ac += cv, 0)/monthMap[key].length;
      }
      console.log(avgMonthlySales);

      let totalSalesPerMonth = 0;
      let counter = 0
      for(key in avgMonthlySales){
        counter++;
        totalSalesPerMonth += avgMonthlySales[key];
      }

      console.log(productName + " AVG SALES PER MONTH: ", totalSalesPerMonth/counter);
    }

  }



	google.charts.load('current', {'packages':['corechart']});
	google.charts.setOnLoadCallback(() => {
    
    const inputFile = document.querySelector("#file");     
    
    inputFile.addEventListener("change", async () => {
      const csvFile = inputFile.files[0]
      dfd.readCSV(csvFile).then((df) => {
        //df.print()
        MYPROCESSDATA(df.values, df.$columns)
        processCSVData(df)
      })
    })

    const processCSVData = (df) => {

      console.log("\nDescribe the dataframe:\n");
      //df.describe().print() // note that describe() only summarizes numeric columns
      //console.log(df.describe())

      // Get values from date column and convert each string into a date obj
      // We'll use this dates array to add columns to our data frame
      //const dates = df["Date"].values.map(d => new Date(d));
      const dates = df["Date"].values.map(d => {
        const [year, month, day] = d.split('-');
        const date = new Date(year, month - 1, day);
        return date;
      });

      
      // Add a column for Age Groups, use the Customer_Age column to do it
      // Age groups are <25, 26-35,36-50,51-65, and 65+
      let ages = df["Customer_Age"].values;
      let ageGroups = ages.map(age => {
        if (age <= 25) return "<25";
        if (age <= 35) return "26-35";
        if (age <= 50) return "36-50";
        if (age <= 65) return "51-65";
        return "65+";
      });

      // Add an Age_Group column to the data frame
      df.addColumn("Age_Group", ageGroups, { inplace: true });


      // Add Month/Year column like  "Aug 2022" so that we can aggregate monthly sales
      //let months = dates.map(d => `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, "0")}`);
      let months = dates.map(d => `${getMonthName(d.getMonth())} ${d.getFullYear()}`);
      df.addColumn("Month", months, { inplace: true });
      
      // helper function to get month name from 
      function getMonthName(monthNumber){
        const months = ["Jan","Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"]
        return months[monthNumber];
      }



      // add column that shows day of week of sale
      let dayNames = dates.map(d => getDayName(d))
      df.addColumn("Day", dayNames, { inplace: true });
      // helper function to get day name from a Date obj
      function getDayName(date){
        days = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
        return days[date.getDay()]
      }


      //--------Create data frames with groupings----------//      

      // Sales by region
      const salesByRegion = df.groupby(["Region"]).col(["Sales"]).sum();

      // Sales by region and product
      const salesByRegionAndProduct = df.groupby(["Region", "Product"]).col(["Sales"]).sum();

      
      // Sales by product and gender
      const salesByProductAndGender = df.groupby(["Product", "Customer_Gender"]).col(["Sales"]).sum();

      // Sales (total) by date:
      const salesByDate = df.groupby(["Date"]).col(["Sales"]).sum();

      // Avg customer satisfaction by product
      const satisfactionByProduct = df.groupby(["Product"]).col(["Customer_Satisfaction"]).mean();

       // Avg customer satisfaction by product and gender
      const satisfactionByProductAndGender = df.groupby(["Product", "Customer_Gender"]).col(["Customer_Satisfaction"]).mean();

      // Avg customer satisfaction by product and gender
      const satisfactionByProductAndAgeGroup = df.groupby(["Product", "Age_Group"]).col(["Customer_Satisfaction"]).mean();


      // Sales by age
      const salesByAge = df.groupby(["Age_Group"]).col(["Sales"]).sum();

      // Sales by product
      const salesByProduct = df.groupby(["Product"]).col(["Sales"]).sum();

      // Sales by product and age
      const salesByProductAndAge = df.groupby(["Product","Age_Group"]).col(["Sales"]).sum();

      // Sales by product, age, and gender
      const salesByProductGenderAndAge = df.groupby(["Product", "Customer_Gender","Age_Group"]).col(["Sales"]).sum();

      // Sales by Age group and gender
      const salesByAgeGroupAndGender = df.groupby(["Age_Group","Customer_Gender"]).col(["Sales"]).sum();
    

      // Group sales by month
      const salesByMonth = df.groupby(["Month"]).col(["Sales"]).sum();

      //// Avg monthly sales by product
      // const avgMonthlySalesByProduct = df.groupby(["Product","Month"]).col(["Sales"]).mean();
      // avgMonthlySalesByProduct.print()
      // console.log(JSON.stringify(avgMonthlySalesByProduct.values))



// TO GET EACH PRODUCTS AVG MONTHLY SALES
let avgSalesByMonth = df.groupby(["Month", "Product", "Sales"]).col(["Sales"]).mean();
avgSalesByMonth.print()
// Now average again, but only by Product
let avgSalesByProduct = avgSalesByMonth.groupby(["Product"]).col(["Sales"]).mean();
avgSalesByProduct.print()




      // Sales by day name
      const salesByDayOfWeek = df.groupby(["Day"]).col(["Sales"]).sum();

      // sales by day of week and product
      const salesByDayOfWeekAndProduct = df.groupby(["Day","Product"]).col(["Sales"]).sum();


      // ---- PRINT RESULTS LOCALLY ---- //
      console.log("\nData Description:\n")
      df.describe().print() // note that describe() only summarizes numeric columns
      
      // I had to do some wrangling to get df.describe().print() into a format that I can feed to the LLMs!!!
      const dfObj = df.describe()
      const columns = [...dfObj.$columns]
      const indexes = [...dfObj.$index]
      const rows = [...dfObj.$data];
      indexes.forEach((indexName, i) => rows[i].unshift(indexName))
      rows.unshift(["Metric", ...columns]);
      console.log(JSON.stringify(rows));
      const dataDescription = rows;
      
      
      


      console.log("\nSales by Region:\n");
      salesByRegion.print(); // Note that print() only prints the first 10 rows
      
      console.log("\nSales by Region and Product:\n");
      salesByRegionAndProduct.print(); 

      console.log("\nAverage Satisfaction by Product:\n");
      satisfactionByProduct.print();

      console.log("\nSales by Product and Gender:\n");
      //console.log(JSON.stringify(salesByProductAndGender.values));
      salesByProductAndGender.print();
      
      console.log("\nAverage Satisfaction by Product and Gender:\n");
      satisfactionByProductAndGender.print();

      console.log("\nAverage Satisfaction by Product and Age Group:\n");
      satisfactionByProductAndAgeGroup.print()


      /*
      By default print() just shows 10 rows, here's how you can get it to show all rows:
      
          df.print({ maxRows: df.shape[0] });
      
      Note that df.shape[0] = number of rows in your DataFrame.
      Passing it as maxRows tells Danfo to display that many rows.
      */
      console.log("\nSales by date:")
      salesByDate.print({ maxRows: salesByDate.shape[0] }); // SHOULD show all rows

      console.log("\nSales by age:")
      salesByAge.print();

      console.log("\nSales by Product:\n");
      salesByProduct.print();

      console.log("\nSales by Product and Age:\n");
      salesByProductAndAge.print();
      
      console.log("\nSales by Product, Gender, and Age:\n");
      salesByProductGenderAndAge.print();

      console.log("\nSales by Month:\n");
      salesByMonth.print();

      console.log("\nSales by Age Group and Gender:\n");
      salesByAgeGroupAndGender.print();

      console.log("\nSales by Day of Week:\n");
      salesByDayOfWeek.print();

      console.log("\nSales by Day of Week and Product:\n");
      salesByDayOfWeekAndProduct.print();
     

      const processedData = {
        dataDescription: dataDescription,
        regionalSales: salesByRegion.values,
        productSalesByRegion: salesByRegionAndProduct.values,
        productSatisfaction: satisfactionByProduct.values,
        salesByProductAndGender: salesByProductAndGender.values,
        satisfactionByProductAndGender: satisfactionByProductAndGender.values,
        satisfactionByProductAndAgeGroup: satisfactionByProductAndAgeGroup.values,
        //salesByDate: salesByDate.values,
        salesByAge: salesByAge.values,
        salesByProduct: salesByProduct.values,
        salesByProductAndAge: salesByProductAndAge.values,
        salesByProductGenderAndAge: salesByProductGenderAndAge.values,
        salesByMonth: salesByMonth.values,
        salesByAgeGroupAndGender: salesByAgeGroupAndGender.values,
        salesByDayOfWeek: salesByDayOfWeek.values,
        salesByDayOfWeekAndProduct: salesByDayOfWeekAndProduct.values
      };
      console.log(JSON.stringify(processedData))


      // ---- CREATE THE CHARTS ----
      createRegionalSalesChart(salesByRegion.values);
      createSalesByRegionAndProductChart(salesByRegionAndProduct.values)
      createProductSatisfactionChart(satisfactionByProduct.values);
      createProductSatisfactionByGenderChart(satisfactionByProductAndGender.values)
      createProductSatisfactionByAgeGroupChart(satisfactionByProductAndAgeGroup.values)
      createSalesByProductandGenderChart(salesByProductAndGender.values);
      createSalesByProductChart(salesByProduct.values)
      // TODO:
      // createSalesByDateChart()?????????????????
      createSalesByAgeChart(salesByAge.values)
      createSalesByProductAndAgeChart(salesByProductAndAge.values)
      //createSalesByProductGenderAndAgeChart(salesByProductGenderAndAge.values)
      createSalesByMonthChart(salesByMonth.values)
      createSalesByAgeGroupAndGenderChart(salesByAgeGroupAndGender.values)
      createSalesByDayOfWeekChart(salesByDayOfWeek.values)
      createSalesByDayOfWeekAndProductChart(salesByDayOfWeekAndProduct.values)



    }// end processCSVData
  

    const createRegionalSalesChart = (data) => {

      const dataTable = google.visualization.arrayToDataTable([
        ["Region", "Sales"],
        ...data
      ],
      false); // 'false' means that the first row contains labels, not data.

			const options = {
				title: "Sales By Region"
			};

			const chart = new google.visualization.ColumnChart(document.querySelector("#regionalSales"));
			chart.draw(dataTable, options)

    }

    const createSalesByRegionAndProductChart = (data) => {
      console.log(data)
      
      /* The data needs to look like this
      [
        ["Region", "Widget A", "Widget B"]
        ["North", 111, 111],
        ["East", 111, 111],
        ["South", 111, 111],
        ["West", 111, 111]
      ]
      */

      const products = data.map(d => d[1])
      const uniqueProducts = [...new Set(products)];

      const regionMap = {}
      data.forEach(([region, product, sales]) => {
        if(!regionMap[region]){
          regionMap[region] = {}
        }
        regionMap[region][product] = sales
      })

      //console.log(regionMap)

      const ar = [["Region", ...uniqueProducts]]
      for(prop in regionMap){
        ar.push([prop, ...uniqueProducts.map(productName => regionMap[prop][productName])])
      }
      //console.log(ar)

      const dataTable = google.visualization.arrayToDataTable(ar, false); // 'false' means that the first row contains labels, not data.

			const options = {
				title: "Sales by Region and Product"
			};

			const chart = new google.visualization.ColumnChart(document.querySelector("#salesByRegionAndProduct"));
			chart.draw(dataTable, options)

    }

    const createProductSatisfactionChart = (data) => {

      const dataTable = google.visualization.arrayToDataTable([
        ["Product", "Satisfaction"],
        ...data
      ],
      false); // 'false' means that the first row contains labels, not data.

			const options = {
				title: "Product Satisfaction"
			};

			const chart = new google.visualization.ColumnChart(document.querySelector("#productSatisfaction"));
			chart.draw(dataTable, options)

    }

    const createProductSatisfactionByGenderChart = (data) => {

      /*
      Here's what the data needs to look like
      [
        ["Product", "Male", "Female"],
        ["Widget A", 1000, 1000]
        ["Widget B", 1000, 1000]
      ]
      */

      //console.log(data)
      const productMap = {}
      data.forEach(([product, gender, satisfaction]) => {
        if (!productMap[product]) {
          productMap[product] = {};
        }
        productMap[product][gender] = satisfaction;
      });
      //console.log(productMap)
      const ar = [["Product", "Male", "Female"]]
      for(prop in productMap){
        ar.push([prop, productMap[prop]["Male"], productMap[prop]["Female"]])
      }

      const dataTable = google.visualization.arrayToDataTable(ar, false); // 'false' means that the first row contains labels, not data.

			const options = {
				title: "Product Satisfaction by Gender"
			};

			const chart = new google.visualization.ColumnChart(document.querySelector("#productSatisfactionByGender"));
			chart.draw(dataTable, options)
    }

    const createProductSatisfactionByAgeGroupChart = (data) => {
      /*
      Here's what the data needs to look like
      [
        ["Product", "<25", "26-35", "36-50", "51-65", "65+"],
        ["Widget A", 1000, 1000, 1000, 1000, 1000]
        ["Widget B", 1000, 1000, 1000, 1000, 1000]
      ]
      */

      //console.log(data)
      const productMap = {}
      data.forEach(([product, ageGroup, satisfaction]) => {
        if (!productMap[product]) {
          productMap[product] = {};
        }
        productMap[product][ageGroup] = satisfaction;
      });
      //console.log(productMap)
      const ar = [["Product", "<25", "26-35", "36-50", "51-65", "65+"]]
      for(prop in productMap){
        ar.push([
          prop, 
          productMap[prop]["<25"], 
          productMap[prop]["26-35"],
          productMap[prop]["36-50"],
          productMap[prop]["51-65"],
          productMap[prop]["65+"],
        ])
      }

      const dataTable = google.visualization.arrayToDataTable(ar, false); 
      // 'false' means that the first row contains labels, not data.

			const options = {
				title: "Product Satisfaction by Age Group"
			};

			const chart = new google.visualization.ColumnChart(document.querySelector("#productSatisfactionByAgeGroup"));
			chart.draw(dataTable, options)
    }

    const createSalesByProductandGenderChart = (data) => {

      /*
      console.log(JSON.stringify(data))

      // This is how the data needs to be formatted:
      const dataTable = google.visualization.arrayToDataTable([
        ["Product", "Male", "Female"],
        ["Widget A", 5000, 10000],
        ["Widget B", 5000, 10000],
        ["Widget C", 5000, 10000],
        ["Widget D", 5000, 10000]
      ],
      false); // 'false' means that the first row contains labels, not data.
      */

      const productMap = {}

      data.forEach(([product, gender, sales]) => {
        if (!productMap[product]) {
          productMap[product] = {};
        }
        productMap[product][gender] = sales;
      });

      //console.log(productMap)

      const ar = [["Product", "Male", "Female"]]
      for(prop in productMap){
        ar.push([prop, productMap[prop]["Male"], productMap[prop]["Female"]])
      }

      //console.log(ar);
      
      const dataTable = google.visualization.arrayToDataTable(ar, false); 
      // 'false' means that the first row contains labels, not data.

      const options = {
				title: "Product Sales by Gender"
			};

			const chart = new google.visualization.ColumnChart(document.querySelector("#salesByProductAndGender"));
			chart.draw(dataTable, options)

    }

    const createSalesByProductChart = (data) => {
      const dataTable = google.visualization.arrayToDataTable([
        ["Product", "Sales"],
        ...data
      ],
      false); // 'false' means that the first row contains labels, not data.

			const options = {
				title: "Product Sales"
			};

			const chart = new google.visualization.ColumnChart(document.querySelector("#productSales"));
			chart.draw(dataTable, options)
    }

    const createSalesByProductAndAgeChart = (data) => {
      
      //console.log(JSON.stringify(data))
      
      /*
      // This is how the data needs to be formatted:
      const dataTable = google.visualization.arrayToDataTable([
        ["Product", "<25", "26-35", "36-50","51-65","65+"],
        ["Widget A", 5000, 10000, 4000, 8000, 7000],
        ["Widget B", 5000, 10000, 4000, 8000, 7000],
        ["Widget C", 5000, 10000, 4000, 8000, 7000],
        ["Widget D", 5000, 10000, 4000, 8000, 7000]
      ],
      false); // 'false' means that the first row contains labels, not data.
      */

      
      const productMap = {}

      data.forEach(([product, ageGroup, sales]) => {
        if (!productMap[product]) {
          productMap[product] = {};
        }
        productMap[product][ageGroup] = sales;
      });

      //console.log(productMap)

      const ar = [["Product", "<25", "26-35", "36-50","51-65","65+"]]
      for(prop in productMap){
        ar.push([prop, productMap[prop]["<25"], productMap[prop]["26-35"], productMap[prop]["36-50"], productMap[prop]["51-65"], productMap[prop]["65+"]])
      }

      //console.log(ar);
      
      const dataTable = google.visualization.arrayToDataTable(ar, false); 
      // 'false' means that the first row contains labels, not data.

      const options = {
				title: "Sales by Product and Age Group",
        isStacked: false //true
			};

			const chart = new google.visualization.ColumnChart(document.querySelector("#salesByProductAndAgeGroup"));
			chart.draw(dataTable, options)
      
    }


    const createSalesByProductGenderAndAgeChart = (data) => {
      //console.log(JSON.stringify(data))
            
      /*
      // This is how the data needs to be formatted:
      const dataTable = google.visualization.arrayToDataTable([
        ["Product", "Gender", "<25", "26-35", "36-50","51-65","65+"],
        ["Widget A","Male", 5000, 10000, 4000, 8000, 7000],
        ["Widget A","Female", 5000, 10000, 4000, 8000, 7000],
        ["Widget B", "Male", 5000, 10000, 4000, 8000, 7000],
        ["Widget B", "Female", 5000, 10000, 4000, 8000, 7000],
        ["Widget C", "Male", 5000, 10000, 4000, 8000, 7000],
        ["Widget C", "Female", 5000, 10000, 4000, 8000, 7000],
        ["Widget D", "Male",5000, 10000, 4000, 8000, 7000],
        ["Widget D", "Female",5000, 10000, 4000, 8000, 7000]
      ],
      false); // 'false' means that the first row contains labels, not data.
      */

      const dataTable = google.visualization.arrayToDataTable([
        // The first column is the label (Product)
        // Subsequent columns are the series, combining Gender and Age.
        ["Product", "Male <25", "Female <25", "Male 26-35", "Female 26-35", "Male 36-50", "Female 36-50", "Male 51-65", "Female 51-65", "Male 65+", "Female 65+"],
        ["Widget A", 5000, 5000, 10000, 10000, 4000, 4000, 8000, 8000, 7000, 7000],
        ["Widget B", 5000, 5000, 10000, 10000, 4000, 4000, 8000, 8000, 7000, 7000],
        ["Widget C", 5000, 5000, 10000, 10000, 4000, 4000, 8000, 8000, 7000, 7000],
        ["Widget D", 5000, 5000, 10000, 10000, 4000, 4000, 8000, 8000, 7000, 7000]
      ],
      false);



      const options = {
				title: "Sales by Product, Gender, and Age Group",
        isStacked: true
			};

			const chart = new google.visualization.ColumnChart(document.querySelector("#salesByProductGenderAndAgeGroup"));
			chart.draw(dataTable, options)
    }

    const createSalesByMonthChart = (data) => {
      const dataTable = google.visualization.arrayToDataTable([
        ["Month", "Sales"],
        ...data
      ],
      false); // 'false' means that the first row contains labels, not data.

			const options = {
				title: "Monthly Sales"
			};

			const chart = new google.visualization.LineChart(document.querySelector("#salesByMonth"));
			chart.draw(dataTable, options)
    }


    const createSalesByAgeChart = (data) => {
      const dataTable = google.visualization.arrayToDataTable([
        ["Age Group", "Sales"],
        ...data
      ],
      false); // 'false' means that the first row contains labels, not data.

			const options = {
				title: "Sales by Age Group"
			};

			const chart = new google.visualization.ColumnChart(document.querySelector("#salesByAgeGroup"));
			chart.draw(dataTable, options)
    }

    const createSalesByAgeGroupAndGenderChart = (data) => {
      
      //console.log(JSON.stringify(data))
      /*
      // This is how the data needs to be formatted:
      const dataTable = google.visualization.arrayToDataTable([
        ["Age Group", "Male", "Female"],
        [">25", 5000, 10000],
        ["26-35", 5000, 10000],
        ["36-50", 5000, 10000],
        ["51-65", 5000, 10000],
        ["65+", 5000, 10000]
      ],
      false); // 'false' means that the first row contains labels, not data.
      */

      
      const ageGroupMap = {}

      data.forEach(([ageGroup, gender, sales]) => {
        if (!ageGroupMap[ageGroup]) {
          ageGroupMap[ageGroup] = {};
        }
        ageGroupMap[ageGroup][gender] = sales;
      });

      //console.log(ageGroupMap)

      const ar = [["Age Group", "Male", "Female"]]
      // for(prop in ageGroupMap){
      //   ar.push([prop, ageGroupMap[prop]["Male"], ageGroupMap[prop]["Female"]])
      // }
      ar.push(["<25", ageGroupMap["<25"]["Male"], ageGroupMap["<25"]["Female"] ])
      ar.push(["26-35", ageGroupMap["26-35"]["Male"], ageGroupMap["26-35"]["Female"] ])
      ar.push(["36-50", ageGroupMap["36-50"]["Male"], ageGroupMap["36-50"]["Female"] ])
      ar.push(["51-65", ageGroupMap["51-65"]["Male"], ageGroupMap["51-65"]["Female"] ])
      ar.push(["65+", ageGroupMap["65+"]["Male"], ageGroupMap["65+"]["Female"] ])

      //console.log(ar);
      
      const dataTable = google.visualization.arrayToDataTable(ar, false); 
      // 'false' means that the first row contains labels, not data.

      const options = {
				title: "Sales by Age Group and Gender"
			};

			const chart = new google.visualization.ColumnChart(document.querySelector("#salesByAgeGroupAndGender"));
			chart.draw(dataTable, options)
      
    }

    const createSalesByDayOfWeekChart = (data) => {
      const dataTable = google.visualization.arrayToDataTable([
        ["Day of Week", "Sales"],
        ...data
      ],
      false); // 'false' means that the first row contains labels, not data.

			const options = {
				title: "Sales by Day of Week"
			};

			const chart = new google.visualization.ColumnChart(document.querySelector("#salesByDayOfWeek"));
			chart.draw(dataTable, options)
    }

    const createSalesByDayOfWeekAndProductChart = (data) => {

      const dayMap = {}

      data.forEach(([day, product, sales]) => {
        if (!dayMap[day]) {
          dayMap[day] = {};
        }
        dayMap[day][product] = sales;
      });

      //console.log(dayMap)
      
      const ar = [["Day", "Widget A", "Widget B", "Widget C", "Widget D"]]
      for(prop in dayMap){
        ar.push([
          prop, 
          dayMap[prop]["Widget A"], 
          dayMap[prop]["Widget B"], 
          dayMap[prop]["Widget C"], 
          dayMap[prop]["Widget D"]
        ])
      }

      //console.log(ar);
      
      const dataTable = google.visualization.arrayToDataTable(ar, false); 
      // 'false' means that the first row contains labels, not data.

      const options = {
				title: "Sales by Day and Product",
        //isStacked: true
			};

			const chart = new google.visualization.LineChart(document.querySelector("#salesByDayAndProduct"));
			chart.draw(dataTable, options)
      
    }

  })


  
  


    
      
</script>
</body>

</html>